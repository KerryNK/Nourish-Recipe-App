{% extends 'base.html' %}
{% load static %}

{% block title %}AI Recipe Assistant - Nourish Recipe App{% endblock %}

{% block content %}
<div class="row">
    <div class="col-lg-8 mx-auto">
        <div class="card border-0 shadow-sm mb-4">
            <div class="card-body text-center p-5">
                <i class="fas fa-robot fa-4x mb-3" style="color: var(--secondary-green);"></i>
                <h2 class="mb-3">AI Recipe Assistant</h2>
                <p class="lead">Find recipes based on ingredients you have!</p>
            </div>
        </div>

        <!-- Search Form -->
        <div class="card border-0 shadow-sm mb-4">
            <div class="card-body p-4">
                <h4 class="mb-3">What ingredients do you have?</h4>
                <form id="ingredient-search-form">
                    <div class="mb-3">
                        <input type="text" id="ingredients-input" class="form-control form-control-lg"
                            placeholder="Enter ingredients separated by commas (e.g., chicken, rice, tomatoes)">
                    </div>
                    <button type="submit" class="btn btn-primary btn-lg w-100">
                        <i class="fas fa-search"></i> Find Recipes
                    </button>
                </form>
            </div>
        </div>

        <!-- Results -->
        <div id="results-container" style="display: none;">
            <h3 class="mb-4">Suggested Recipes</h3>
            <div id="recipe-results" class="row"></div>
        </div>

        <!-- No Results -->
        <div id="no-results" style="display: none;" class="alert alert-info">
            <i class="fas fa-info-circle"></i> No recipes found with those ingredients. Try different combinations!
        </div>
    </div>
</div>

<script>
    document.getElementById('ingredient-search-form').addEventListener('submit', function (e) {
        e.preventDefault();

        const input = document.getElementById('ingredients-input').value.trim();
        if (!input) return;

        const ingredients = input.split(',').map(i => i.trim().toLowerCase());

        // Simple client-side search through recipes
        fetch('/recipes/')
            .then(response => response.text())
            .then(html => {
                // This is a simplified version - in production, you'd want a proper API endpoint
                searchRecipes(ingredients);
            });
    });

    function searchRecipes(ingredients) {
        // For now, we'll redirect to recipes page with a search parameter
        // In a full implementation, this would call an API endpoint
        const resultsContainer = document.getElementById('results-container');
        const recipeResults = document.getElementById('recipe-results');
        const noResults = document.getElementById('no-results');

        // Show loading
        recipeResults.innerHTML = '<div class="col-12 text-center"><i class="fas fa-spinner fa-spin fa-3x"></i></div>';
        resultsContainer.style.display = 'block';
        noResults.style.display = 'none';

        // Simulate API call with timeout
        setTimeout(() => {
            recipeResults.innerHTML = `
            <div class="col-12">
                <div class="alert alert-success">
                    <i class="fas fa-lightbulb"></i> 
                    <strong>Tip:</strong> Browse our <a href="/recipes/" class="alert-link">recipes page</a> 
                    to find dishes you can make with your ingredients!
                </div>
                <div class="text-center mt-4">
                    <a href="/recipes/" class="btn btn-primary btn-lg">
                        <i class="fas fa-book"></i> Browse All Recipes
                    </a>
                </div>
            </div>
        `;
        }, 1000);
    }
</script>
{% endblock %}